// Generated by CoffeeScript 1.6.3
var Event, EventDetails, Events, Footer, Header, Home, Login, Main, SingleEventList;

Main = function($scope, $rootScope, $rootElement, $route) {
  $scope.updateCurrentSection = function(current) {
    return $scope.activeSection = (current != null) && (current.params.filterType != null) ? current.params.filterType : "home";
  };
  $scope.$on("$routeChangeStart", function(prev, current) {
    $scope.updateCurrentSection(current);
    return $rootElement.attr("class", current.$$route.controller.toLowerCase());
  });
  $scope.$on("event:open", function(_event, evento) {
    $("html").addClass("has-event-open");
    $scope.currentEvent = evento;
    return $rootScope.$broadcast("currentevent:update", evento);
  });
  $scope.$on("event:close", function(_event, evento) {
    $("html").removeClass("has-event-open");
    return $scope.currentEvent = false;
  });
  return $scope.updateCurrentSection($route.current);
};

Header = function() {
  return $(".main-region").css("padding-top", $(".header-region").outerHeight());
};

Footer = function() {
  return $(".main-region").css("padding-bottom", $(".footer-region").height());
};

Home = function($scope, $http) {
  $scope.loading = true;
  $http.get(Nscf.apiUrl + "events/today").success(function(data) {
    $scope.events = data;
    return $scope.loading = false;
  });
  $("html").addClass("main-view-static");
  $(".center-view").height($(".main-view").height());
  return $(".side-view").height($(".main-view").height());
};

Events = function($scope, $routeParams, $http) {
  var mainRegionHeight;
  $scope.loading = true;
  $http.get(Nscf.apiUrl + "events/filter/" + $scope.activeSection).success(function(data) {
    $scope.events = data;
    return $scope.loading = false;
  });
  $(".events-container .nav-tabs a").click(function(event) {
    event.preventDefault();
    return $(this).tab("show");
  });
  $("html").addClass("main-view-static");
  mainRegionHeight = $(".main-view").height();
  $(".events-container .tab-content").height(mainRegionHeight - $(".events-container .nav-tabs").outerHeight());
  return $(".side-view").height(mainRegionHeight);
};

SingleEventList = function($rootScope, $element, $scope) {
  $scope.init = function(ev) {
    return $scope.event = ev;
  };
  $scope.getEventImage = function() {
    return Nscf.apiUrl + "events/" + $scope.event.id + "/image";
  };
  $scope.openEvent = function() {
    if ($element.hasClass("active") === false) {
      $scope.$emit("event:open", $scope.event);
      $element.addClass("active");
    } else {
      $scope.$emit("event:close", $scope.event);
      $element.removeClass("active");
    }
    return true;
  };
  return $element.find(".event-social a").on("click", function(event) {
    return event.stopPropagation();
  });
};

EventDetails = function($scope, $element) {
  $scope.event = false;
  $scope.getEventImage = function() {
    return Nscf.apiUrl + "events/" + $scope.event.id + "/image";
  };
  $scope.$on("currentevent:update", function(_event, evento) {
    console.log("EVENTO", evento);
    $scope.event = evento;
    return $scope.createMap();
  });
  return $scope.createMap = function() {
    var eventLatlng, gps, marker, options;
    gps = $scope.event.GPS_L.split(",");
    eventLatlng = new google.maps.LatLng(gps[0], gps[1]);
    options = {
      zoom: 10,
      center: eventLatlng,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    $scope.map = new google.maps.Map($element.find("#map")[0], options);
    return marker = new google.maps.Marker({
      position: eventLatlng,
      map: $scope.map,
      title: $scope.event.nome
    });
  };
};

Event = function($scope, $routeParams, $http) {
  $scope.loading = true;
  $http.get(Nscf.apiUrl + "/event&id=" + $routeParams.id).success(function(data) {
    $scope.ev = data;
    return $scope.loading = false;
  });
  return $scope.getDay = function(data) {
    return data.split("/")[0];
  };
};

Login = function($scope) {
  return false;
};
